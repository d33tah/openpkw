-- MySQL Script generated by MySQL Workbench
-- 08/27/15 16:15:51
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema openpkw2
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema openpkw2
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `openpkw2` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
USE `openpkw2` ;

-- -----------------------------------------------------
-- Table `openpkw2`.`USER_TYPE`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `openpkw2`.`USER_TYPE` ;

CREATE TABLE IF NOT EXISTS `openpkw2`.`USER_TYPE` (
  `USER_TYPE_ID` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `USER_TYPE` VARCHAR(45) NULL COMMENT '',
  PRIMARY KEY (`USER_TYPE_ID`)  COMMENT '',
  UNIQUE INDEX `USER_TYPE_ID_UNIQUE` (`USER_TYPE_ID` ASC)  COMMENT '')
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `openpkw2`.`USER`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `openpkw2`.`USER` ;

CREATE TABLE IF NOT EXISTS `openpkw2`.`USER` (
  `USER_ID` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `USER_TYPE_ID` INT NOT NULL COMMENT '',
  `FIRST_NAME` VARCHAR(45) NOT NULL COMMENT '',
  `LAST_NAME` VARCHAR(45) NOT NULL COMMENT '',
  `EMAIL` VARCHAR(45) NULL COMMENT '',
  `PASSWORD` VARCHAR(45) NOT NULL COMMENT '',
  `IS_ACTIVE` TINYINT(1) NOT NULL COMMENT '',
  `TOKEN` VARCHAR(10) NOT NULL COMMENT '',
  `TOKEN_CREATED_DATE` TIMESTAMP NOT NULL COMMENT '',
  UNIQUE INDEX `USER_ID_UNIQUE` (`USER_ID` ASC)  COMMENT '',
  PRIMARY KEY (`USER_ID`)  COMMENT '',
  UNIQUE INDEX `EMAIL_UNIQUE` (`EMAIL` ASC)  COMMENT '',
  INDEX `fk_USER_USER_TYPE1_idx` (`USER_TYPE_ID` ASC)  COMMENT '',
  CONSTRAINT `fk_USER_USER_TYPE1`
    FOREIGN KEY (`USER_TYPE_ID`)
    REFERENCES `openpkw2`.`USER_TYPE` (`USER_TYPE_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `openpkw2`.`PERIPHERAL_COMMITTEE_ADDRESS`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `openpkw2`.`PERIPHERAL_COMMITTEE_ADDRESS` ;

CREATE TABLE IF NOT EXISTS `openpkw2`.`PERIPHERAL_COMMITTEE_ADDRESS` (
  `PERIPHERAL_COMMITTEE_ADDRESS_ID` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `NAME` VARCHAR(300) NULL COMMENT '',
  `STREET` VARCHAR(45) NOT NULL COMMENT '',
  `BUILDING_NUMBER` VARCHAR(10) NOT NULL COMMENT '',
  `ROOM_NUMBER` VARCHAR(45) NULL COMMENT '',
  `CITY` VARCHAR(45) NOT NULL COMMENT '',
  `POSTAL_CODE` VARCHAR(45) NOT NULL COMMENT '',
  `POST` VARCHAR(45) NOT NULL COMMENT '',
  PRIMARY KEY (`PERIPHERAL_COMMITTEE_ADDRESS_ID`)  COMMENT '')
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `openpkw2`.`PERIPHERAL_COMMITTEE`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `openpkw2`.`PERIPHERAL_COMMITTEE` ;

CREATE TABLE IF NOT EXISTS `openpkw2`.`PERIPHERAL_COMMITTEE` (
  `PERIPHERAL_COMMITTEE_ID` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `PERIPHERAL_COMMITTEE_ADDRESS_ID` INT NOT NULL COMMENT '',
  `NAME` VARCHAR(45) NULL COMMENT '',
  `TYPE` VARCHAR(45) NULL COMMENT '',
  `ALLOWED_TO_VOTE` INT NOT NULL COMMENT '',
  `TERRITORIAL_CODE` VARCHAR(45) NOT NULL COMMENT '',
  `PERIPHERAL_CODE` VARCHAR(45) NOT NULL COMMENT '',
  PRIMARY KEY (`PERIPHERAL_COMMITTEE_ID`)  COMMENT '',
  INDEX `fk_PERIPHERAL_COMMITTEE_PERIPHERAL_COMMITTEE_ADDRESS1_idx` (`PERIPHERAL_COMMITTEE_ADDRESS_ID` ASC)  COMMENT '',
  CONSTRAINT `fk_PERIPHERAL_COMMITTEE_PERIPHERAL_COMMITTEE_ADDRESS1`
    FOREIGN KEY (`PERIPHERAL_COMMITTEE_ADDRESS_ID`)
    REFERENCES `openpkw2`.`PERIPHERAL_COMMITTEE_ADDRESS` (`PERIPHERAL_COMMITTEE_ADDRESS_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `openpkw2`.`PROTOCOL`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `openpkw2`.`PROTOCOL` ;

CREATE TABLE IF NOT EXISTS `openpkw2`.`PROTOCOL` (
  `PROTOCOL_ID` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `PERIPHERAL_COMMITTEE_ID` INT NOT NULL COMMENT '',
  `NAME` VARCHAR(45) NOT NULL COMMENT '',
  `CARDS_GIVEN` INT NOT NULL COMMENT '',
  `RECEIVED_DATE` TIMESTAMP NOT NULL COMMENT '',
  PRIMARY KEY (`PROTOCOL_ID`)  COMMENT '',
  INDEX `fk_PROTOCOL_PERIPHERAL_COMMITTEE1_idx` (`PERIPHERAL_COMMITTEE_ID` ASC)  COMMENT '',
  CONSTRAINT `fk_PROTOCOL_PERIPHERAL_COMMITTEE1`
    FOREIGN KEY (`PERIPHERAL_COMMITTEE_ID`)
    REFERENCES `openpkw2`.`PERIPHERAL_COMMITTEE` (`PERIPHERAL_COMMITTEE_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `openpkw2`.`PHOTO`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `openpkw2`.`PHOTO` ;

CREATE TABLE IF NOT EXISTS `openpkw2`.`PHOTO` (
  `PHOTO_ID` INT NOT NULL AUTO_INCREMENT COMMENT '',
  `PROTOCOL_PROTOCOL_ID` INT NOT NULL COMMENT '',
  `TIMESTAMP` TIMESTAMP NULL COMMENT '',
  `USER_ID` INT NULL COMMENT '',
  `USER_FILE_NAME` VARCHAR(45) NULL COMMENT '',
  `TOKEN` VARCHAR(45) NULL COMMENT '',
  `FILETYPE` VARCHAR(45) NULL COMMENT '',
  PRIMARY KEY (`PHOTO_ID`)  COMMENT '',
  INDEX `fk_PHOTO_PROTOCOL1_idx` (`PROTOCOL_PROTOCOL_ID` ASC)  COMMENT '',
  CONSTRAINT `fk_PHOTO_PROTOCOL1`
    FOREIGN KEY (`PROTOCOL_PROTOCOL_ID`)
    REFERENCES `openpkw2`.`PROTOCOL` (`PROTOCOL_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `openpkw2`.`QUESTION`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `openpkw2`.`QUESTION` ;

CREATE TABLE IF NOT EXISTS `openpkw2`.`QUESTION` (
  `QUESTION_ID` INT NOT NULL COMMENT '',
  `PROTOCOL_ID` INT NOT NULL COMMENT '',
  `CONTENT` TEXT NULL COMMENT '',
  `YES_ANSWERS_AMOUNT` INT NOT NULL COMMENT '',
  `NO_ANSWERS_AMOUNT` INT NOT NULL COMMENT '',
  `INVALID_ANSWERS_AMOUNT` INT NULL COMMENT '',
  `VALID_ANSWERS_AMOUNT` INT NULL COMMENT '',
  PRIMARY KEY (`QUESTION_ID`, `PROTOCOL_ID`)  COMMENT '',
  INDEX `fk_QUESTION_PROTOCOL1_idx` (`PROTOCOL_ID` ASC)  COMMENT '',
  CONSTRAINT `fk_QUESTION_PROTOCOL1`
    FOREIGN KEY (`PROTOCOL_ID`)
    REFERENCES `openpkw2`.`PROTOCOL` (`PROTOCOL_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
